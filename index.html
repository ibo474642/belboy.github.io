<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oda Gelir Takip</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <button class="menu-button" id="menuButton" aria-label="Men√ºy√º a√ß veya kapat">‚ò∞ Men√º</button>
        <div class="menu" id="menu">
            <div class="refresh-rates">
                <button class="refresh-button" id="refreshRatesButton" aria-label="D√∂viz kurlarƒ±nƒ± yenile">
                    <span>üîÑ</span> Kurlarƒ± Yenile
                </button>
            </div>
            <div class="last-update" id="lastUpdate">Son G√ºncelleme: Y√ºkleniyor...</div>
            <div class="menu-item" id="unpaidMenu" role="button" tabindex="0" aria-label="Vermeyenler listesini g√∂ster">Vermeyenler</div>
            <div class="menu-item" id="paidMenu" role="button" tabindex="0" aria-label="Verenler listesini g√∂ster">Verenler</div>
            <div class="menu-item" id="lastTransactionsMenu" role="button" tabindex="0" aria-label="Son i≈ülemleri g√∂ster">Son ƒ∞≈ülemler</div>
            <div class="menu-item" id="reportMenu" role="button" tabindex="0" aria-label="Raporlarƒ± g√∂ster">Raporlar</div>
            <div class="menu-item" id="statsMenu" role="button" tabindex="0" aria-label="ƒ∞statistikleri g√∂ster">ƒ∞statistikler</div>
            <div class="menu-item" id="accountingMenu" role="button" tabindex="0" aria-label="Muhasebe ekranƒ±nƒ± g√∂ster">Muhasebe</div>
            <div class="menu-item" id="storageMenu" role="button" tabindex="0" aria-label="Depolama durumunu g√∂ster">Depolama</div>
            <div class="theme-switch-container">
                <label class="theme-switch" aria-label="Tema deƒüi≈ütir">
                    <input type="checkbox" id="themeToggle" aria-label="Koyu ve a√ßƒ±k tema arasƒ±nda ge√ßi≈ü yap">
                    <span class="slider">
                        <span class="moon">üåô</span>
                        <span class="sun">‚òÄÔ∏è</span>
                    </span>
                </label>
            </div>
        </div>
        
        <div class="header">
            <img src="https://i.hizliresim.com/83vyku0.png" alt="Oda Gelir Takip Logosu">
        </div>
        
        <div class="form-group">
            <label for="roomNumber">Oda No:</label>
            <input type="text" id="roomNumber" placeholder="Oda numarasƒ±nƒ± girin" inputmode="numeric" pattern="[0-9]+" required>
        </div>
        
        <div class="exchange-container">
            <div class="date-filter-item">
                <label for="date">Tarih:</label>
                <input type="date" id="date" max="" required>
            </div>
            <div class="form-group">
                <label for="currency">D√∂viz Tipi:</label>
                <select id="currency">
                    <option value="TL" selected>TL</option>
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="GBP">GBP</option>
                </select>
            </div>
            <div class="animated-exchange" id="exchangeRates">
                <div class="currency-badge usd">
                    <div class="currency-content">
                        <span class="currency-icon">üíµ</span>
                        <span class="currency-text">USD <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
                <div class="currency-badge eur">
                    <div class="currency-content">
                        <span class="currency-icon">üí∂</span>
                        <span class="currency-text">EUR <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
                <div class="currency-badge gbp">
                    <div class="currency-content">
                        <span class="currency-icon">üí∑</span>
                        <span class="currency-text">GBP <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="manual-rates" id="manualRates">
            <h4>Manuel Kur Giri≈üi</h4>
            <div>
                <label for="manualUSD">USD:</label>
                <input type="number" id="manualUSD" step="0.01" placeholder="32.45" min="0">
                <label for="manualEUR">EUR:</label>
                <input type="number" id="manualEUR" step="0.01" placeholder="35.18" min="0">
                <label for="manualGBP">GBP:</label>
                <input type="number" id="manualGBP" step="0.01" placeholder="41.32" min="0">
                <button onclick="saveManualRates()" aria-label="Manuel kurlarƒ± kaydet">Kaydet</button>
            </div>
        </div>
        
        <div class="form-group">
            <label>√ñdeme Durumu:</label>
            <div class="radio-group">
                <div class="radio-option" id="notPaidOption">
                    <label class="radio-label" for="notPaid">VERMEDƒ∞</label>
                    <input type="radio" id="notPaid" name="amount" value="VERMEDƒ∞" checked>
                    <span class="custom-radio"></span>
                </div>
                <div class="radio-option" id="customAmountOption">
                    <label class="radio-label" for="customAmount">VERDƒ∞</label>
                    <input type="radio" id="customAmount" name="amount" value="custom">
                    <span class="custom-radio"></span>
                </div>
                <input type="number" id="amountInput" class="amount-input" placeholder="Tutar girin" disabled min="0" step="0.01">
            </div>
        </div>
        <button id="saveButton" aria-label="Verileri kaydet">Kaydet</button>
    </div>

    <div id="unpaidModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('unpaidModal')" role="button" tabindex="0" aria-label="Vermeyenler modalƒ±nƒ± kapat">√ó</span>
            <h2>Vermeyenler Listesi</h2>
            <div class="date-filter-container">
                <div class="time-range-selector">
                    <select id="unpaidTimeRange" onchange="updateUnpaidDateRange()" aria-label="Vermeyenler i√ßin zaman aralƒ±ƒüƒ± se√ß">
                        <option value="today">Bug√ºn</option>
                        <option value="yesterday">D√ºn</option>
                        <option value="lastWeek">Son 7 G√ºn</option>
                        <option value="lastMonth">Son 30 G√ºn</option>
                        <option value="custom">√ñzel Tarih</option>
                    </select>
                </div>
                <div class="date-filter" id="unpaidDateFilter" style="display:none">
                    <div class="date-filter-item">
                        <label for="unpaidStartDate">Ba≈ülangƒ±√ß Tarihi</label>
                        <input type="date" id="unpaidStartDate" max="">
                    </div>
                    <div class="date-filter-item">
                        <label for="unpaidEndDate">Biti≈ü Tarihi</label>
                        <input type="date" id="unpaidEndDate" max="">
                    </div>
                </div>
                <button class="filter-button" onclick="filterUnpaidTable()" aria-label="Vermeyenler listesini filtrele">Filtrele</button>
            </div>
            <div id="unpaidTotal" class="single-total"></div>
            <table id="unpaidTable">
                <thead>
                    <tr>
                        <th>Oda No</th>
                        <th>Vermeme Sayƒ±sƒ±</th>
                        <th>Son Tarih</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="paidModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('paidModal')" role="button" tabindex="0" aria-label="Verenler modalƒ±nƒ± kapat">√ó</span>
            <h2>Verenler Listesi</h2>
            <div class="date-filter-container">
                <div class="currency-selector">
                    <label for="paidCurrency">D√∂viz:</label>
                    <select id="paidCurrency" onchange="filterPaidTable()" aria-label="Verenler i√ßin d√∂viz tipi se√ß">
                        <option value="all">T√ºm√º</option>
                        <option value="TL">TL</option>
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                    </select>
                </div>
                <div class="time-range-selector">
                    <select id="paidTimeRange" onchange="updatePaidDateRange()" aria-label="Verenler i√ßin zaman aralƒ±ƒüƒ± se√ß">
                        <option value="today">Bug√ºn</option>
                        <option value="yesterday">D√ºn</option>
                        <option value="lastWeek">Son 7 G√ºn</option>
                        <option value="lastMonth">Son 30 G√ºn</option>
                        <option value="custom">√ñzel Tarih</option>
                    </select>
                </div>
                <div class="date-filter" id="paidDateFilter" style="display:none">
                    <div class="date-filter-item">
                        <label for="paidStartDate">Ba≈ülangƒ±√ß Tarihi</label>
                        <input type="date" id="paidStartDate" max="">
                    </div>
                    <div class="date-filter-item">
                        <label for="paidEndDate">Biti≈ü Tarihi</label>
                        <input type="date" id="paidEndDate" max="">
                    </div>
                </div>
                <button class="filter-button" onclick="filterPaidTable()" aria-label="Verenler listesini filtrele">Filtrele</button>
            </div>
            <div id="paidTotalSingle" class="single-total"></div>
            <div id="paidAllTotals" class="total-container"></div>
            <table id="paidTable">
                <thead>
                    <tr>
                        <th>Oda No</th>
                        <th>D√∂viz</th>
                        <th>Toplam</th>
                        <th>Son Tarih</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="lastTransactionsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('lastTransactionsModal')" role="button" tabindex="0" aria-label="Son i≈ülemler modalƒ±nƒ± kapat">√ó</span>
            <h2>Son ƒ∞≈ülemler</h2>
            <div class="container">
                <div class="currency-selector">
                    <label for="transactionsCurrency">D√∂viz:</label>
                    <select id="transactionsCurrency" onchange="filterTransactionsTable()" aria-label="Son i≈ülemler i√ßin d√∂viz tipi se√ß">
                        <option value="all">T√ºm√º</option>
                        <option value="TL">TL</option>
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                    </select>
                </div>
                <div class="time-range-selector">
                    <select id="transactionsTimeRange" onchange="updateTransactionsDateRange()" aria-label="Son i≈ülemler i√ßin zaman aralƒ±ƒüƒ± se√ß">
                        <option value="today">Bug√ºn</option>
                        <option value="yesterday">D√ºn</option>
                        <option value="lastWeek">Son 7 G√ºn</option>
                        <option value="lastMonth">Son 30 G√ºn</option>
                        <option value="custom">√ñzel Tarih</option>
                    </select>
                </div>
                <div class="date-filter" id="transactionsDateFilter" style="display:none">
                    <div class="date-filter-item">
                        <label for="transactionsStartDate">Ba≈ülangƒ±√ß Tarihi</label>
                        <input type="date" id="transactionsStartDate" max="">
                    </div>
                    <div class="date-filter-item">
                        <label for="transactionsEndDate">Biti≈ü Tarihi</label>
                        <input type="date" id="transactionsEndDate" max="">
                    </div>
                </div>
                <button class="filter-button" onclick="filterTransactionsTable()" aria-label="Son i≈ülemleri filtrele">Filtrele</button>
            </div>
            <div id="transactionsTotalSingle" class="single-total"></div>
            <div id="transactionsAllTotals" class="total-container"></div>
            <table id="lastTransactionsTable">
                <thead>
                    <tr>
                        <th>Tarih</th>
                        <th>Oda No</th>
                        <th>D√∂viz</th>
                        <th>Tutar</th>
                        <th>ƒ∞≈ülem</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div id="reportModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('reportModal')" role="button" tabindex="0" aria-label="Raporlar modalƒ±nƒ± kapat">√ó</span>
            <h2>Gelir Raporlarƒ±</h2>
            <div class="report-controls">
                <div class="month-navigation">
                    <span class="nav-arrow" onclick="changeMonth(-1)" role="button" tabindex="0" aria-label="√ñnceki ay">‚ùÆ</span>
                    <span id="currentMonth" class="current-month"></span>
                    <span class="nav-arrow" onclick="changeMonth(1)" role="button" tabindex="0" aria-label="Sonraki ay">‚ùØ</span>
                </div>
                <div class="currency-filter">
                    <div class="currency-btn active" data-currency="TL" onclick="toggleCurrency('TL')" role="button" tabindex="0" aria-label="TL grafiƒüini g√∂ster">TL</div>
                    <div class="currency-btn" data-currency="USD" onclick="toggleCurrency('USD')" role="button" tabindex="0" aria-label="USD grafiƒüini g√∂ster">USD</div>
                    <div class="currency-btn" data-currency="EUR" onclick="toggleCurrency('EUR')" role="button" tabindex="0" aria-label="EUR grafiƒüini g√∂ster">EUR</div>
                    <div class="currency-btn" data-currency="GBP" onclick="toggleCurrency('GBP')" role="button" tabindex="0" aria-label="GBP grafiƒüini g√∂ster">GBP</div>
                </div>
                <div class="chart-type-selector">
                    <label for="chartType">Grafik T√ºr√º:</label>
                    <select id="chartType" onchange="updateReportChart()" aria-label="Grafik t√ºr√ºn√º se√ß">
                        <option value="line">√áizgi</option>
                        <option value="bar">S√ºtun</option>
                        <option value="area">Alan</option>
                    </select>
                </div>
            </div>
            <canvas id="reportChart"></canvas>
        </div>
    </div>

    <div id="statsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('statsModal')" role="button" tabindex="0" aria-label="ƒ∞statistikler modalƒ±nƒ± kapat">√ó</span>
            <h2>ƒ∞statistikler</h2>
            <div class="general-stats">
                <div class="general-stat-card">
                    <div class="general-stat-header">Toplam Oda Sayƒ±sƒ±</div>
                    <div class="general-stat-value" id="totalRooms">0</div>
                    <div class="general-stat-detail">Kayƒ±tlƒ± toplam oda sayƒ±sƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">Ortalama √ñdeme Oranƒ±</div>
                    <div class="general-stat-value" id="avgPaymentRate">0%</div>
                    <div class="general-stat-detail">√ñdeme yapanlarƒ±n oranƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">Toplam ƒ∞≈ülem Sayƒ±sƒ±</div>
                    <div class="general-stat-value" id="totalTransactions">0</div>
                    <div class="general-stat-detail">Kayƒ±tlƒ± toplam i≈ülem sayƒ±sƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">En Y√ºksek √ñdemeler</div>
                    <div class="general-stat-value" id="maxTlPayment">0 TL</div>
                    <div class="general-stat-detail" id="maxTlRoom">Oda: -</div>
                </div>
            </div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">En √áok √ñdeme Yapanlar</div>
                    <div class="top-list" id="topPayers"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">En √áok √ñdeme Atlayanlar</div>
                    <div class="top-list" id="topNonPayers"></div>
                </div>
            </div>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <canvas id="paymentRatioChart"></canvas>
                </div>
                <div class="chart-wrapper">
                    <canvas id="currencyRatioChart"></canvas>
                </div>
            </div>
            <div class="comparison-chart-container">
                <canvas id="comparisonChart"></canvas>
            </div>
        </div>
    </div>

    <div id="accountingModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('accountingModal')" role="button" tabindex="0" aria-label="Muhasebe modalƒ±nƒ± kapat">√ó</span>
            <h2>Muhasebe</h2>
            <div class="date-filter-container">
                <div class="time-range-selector">
                    <select id="accountingTimeRange" onchange="updateAccountingDateRange()" aria-label="Muhasebe i√ßin zaman aralƒ±ƒüƒ± se√ß">
                        <option value="today">Bug√ºn</option>
                        <option value="yesterday">D√ºn</option>
                        <option value="lastWeek">Son 7 G√ºn</option>
                        <option value="lastMonth">Son 30 G√ºn</option>
                        <option value="custom">√ñzel Tarih</option>
                    </select>
                </div>
                <div class="date-filter" id="accountingDateFilter" style="display:none">
                    <div class="date-filter-item">
                        <label for="accountingStartDate">Ba≈ülangƒ±√ß Tarihi</label>
                        <input type="date" id="accountingStartDate" max="">
                    </div>
                    <div class="date-filter-item">
                        <label for="accountingEndDate">Biti≈ü Tarihi</label>
                        <input type="date" id="accountingEndDate" max="">
                    </div>
                </div>
                <button class="filter-button" onclick="showAccountingSummary()" aria-label="Muhasebe √∂zetini g√∂ster">G√∂ster</button>
            </div>
            <div id="accountingSummary" class="accounting-summary"></div>
            <div class="chart-container">
                <div class="chart-wrapper">
                    <canvas id="accountingPieChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <div id="storageModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('storageModal')" role="button" tabindex="0" aria-label="Depolama modalƒ±nƒ± kapat">√ó</span>
            <h2>Depolama Durumu</h2>
            <div class="storage-metrics">
                <div class="metric">
                    <span>Toplam Kayƒ±t:</span>
                    <span id="totalRecords">0</span>/<span id="maxRecords">5,000</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="storageProgress"></div>
                </div>
                <div class="progress-text" id="progressPercent">0%</div>
                <div class="storage-details">
                    <div class="storage-detail">
                        <span class="detail-label">Kullanƒ±lan Alan</span>
                        <span class="detail-value" id="usedStorage">0.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Toplam Alan</span>
                        <span class="detail-value">5.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Kalan Alan</span>
                        <span class="detail-value" id="freeStorage">5.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Kalan Kayƒ±t</span>
                        <span class="detail-value" id="remainingRecords">5,000</span>
                    </div>
                </div>
                <button class="report-button" onclick="generatePDFReport()" aria-label="Raporu PDF olarak indir">Raporla</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9422d2ffeea45912',t:'MTc0NzY0OTYzMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
