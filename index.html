<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oda Gelir Takip</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lz-string"></script>
</head>
<body>
    <div class="header">
        <img src="https://i.hizliresim.com/83vyku0.png" alt="Oda Gelir Takip Logosu" alt="Logo">
        <button id="menuButton" class="menu-button">‚ò∞ Men√º</button>
        <div id="menu" class="menu">
            <div button id="refreshRatesButton" class="refresh-button">üîÑ Kurlarƒ± Yenile</button></div>
            <div id="unpaidMenu" class="menu-item">Vermeyenler</div>
            <div id="paidMenu" class="menu-item">Verenler</div>
            <div id="lastTransactionsMenu" class="menu-item">Son ƒ∞≈ülemler</div>
            <div id="reportMenu" class="menu-item">Raporlar</div>
            <div id="statsMenu" class="menu-item">ƒ∞statistikler</div>
            <div id="accountingMenu" class="menu-item">Muhasebe</div>
            <div id="storageMenu" class="menu-item">Depolama</div>
            <div class="theme-switch-container">
                <label class="theme-switch">
                    <input type="checkbox" id="themeToggle">
                    <span class="slider">
                        <span class="moon">üåô</span>
                        <span class="sun">‚òÄÔ∏è</span>
                    </span>
                </label>
            </div>
        </div>
    </div>



    <div class="container">
        <div class="date-currency-row">
            <div class="form-group">
                <label for="date">Tarih:</label>
                <input type="date" id="date" name="date">
            </div>
            <div class="form-group">
                <label for="currency">D√∂viz Tipi:</label>
                <select id="currency" name="currency">
                    <option value="TL">TL</option>
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="GBP">GBP</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label>Oda No:</label>
            <input type="text" id="roomNumber" placeholder="Oda numarasƒ±nƒ± girin">
        </div>
        <div class="form-group">
            <label>√ñdeme Durumu:</label>
            <div class="radio-group">
                <label class="radio-option">
                    VERMEDƒ∞
                    <input type="radio" id="notPaid" name="paymentStatus" value="notPaid" checked>
                    <span class="custom-radio"></span>
                </label>
                <label class="radio-option">
                    VERDƒ∞
                    <input type="radio" id="customAmount" name="paymentStatus" value="customAmount">
                    <span class="custom-radio"></span>
                </label>
            </div>
        </div>
        <div class="form-group">
            <input type="number" id="amountInput" class="amount-input" placeholder="Tutar" disabled>
        </div>
        <button id="saveButton">Kaydet</button>
    </div>
    
        <div class="container">
        <div class="exchange-container">
            <div class="animated-exchange">
                <div class="currency-badge usd">
                    <div class="currency-content">
                        <span class="currency-icon">üíµ</span>
                        <span class="currency-text">USD <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
                <div class="currency-badge eur">
                    <div class="currency-content">
                        <span class="currency-icon">üí∂</span>
                        <span class="currency-text">EUR <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
                <div class="currency-badge gbp">
                    <div class="currency-content">
                        <span class="currency-icon">üí∑</span>
                        <span class="currency-text">GBP <span class="rate">Y√ºkleniyor...</span>‚Ç∫</span>
                    </div>
                </div>
            </div>
            
        </div>
        <div id="lastUpdate" class="last-update">Son G√ºncelleme: Y√ºkleniyor...</div>
        <div id="manualRates" class="manual-rates">
            <h4>Manuel Kur Giri≈üi</h4>
            <label>USD: <input type="number" id="manualUSD" step="0.01"></label>
            <label>EUR: <input type="number" id="manualEUR" step="0.01"></label>
            <label>GBP: <input type="number" id="manualGBP" step="0.01"></label>
            <button onclick="saveManualRates()">Kaydet</button>
        </div>
    </div>

    <div id="unpaidModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('unpaidModal')">√ó</span>
            <h2>Vermeyenler Listesi</h2>
            <div class="time-range-selector">
                <select id="unpaidTimeRange" onchange="updateUnpaidDateRange()">
                    <option value="today">Bug√ºn</option>
                    <option value="yesterday">D√ºn</option>
                    <option value="lastWeek">Son 7 G√ºn</option>
                    <option value="lastMonth">Son 30 G√ºn</option>
                    <option value="custom">√ñzel Tarih</option>
                </select>
            </div>
            <div id="unpaidDateFilter" class="date-filter" style="display: none;">
                <div class="date-filter-item">
                    <label>Ba≈ülangƒ±√ß Tarihi</label>
                    <input type="date" id="unpaidStartDate">
                </div>
                <div class="date-filter-item">
                    <label>Biti≈ü Tarihi</label>
                    <input type="date" id="unpaidEndDate">
                </div>
            </div>
            <button class="filter-button" onclick="filterUnpaidTable()">Filtrele</button>
            <table id="unpaidTable">
                <thead>
                    <tr>
                        <th>Oda No</th>
                        <th>Vermeme Sayƒ±sƒ±</th>
                        <th>Son Tarih</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div id="unpaidTotal" class="single-total"></div>
        </div>
    </div>

    <div id="paidModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('paidModal')">√ó</span>
            <h2>Verenler Listesi</h2>
            <div class="currency-selector">
                <label>D√∂viz:</label>
                <select id="paidCurrency">
                    <option value="all">T√ºm√º</option>
                    <option value="TL">TL</option>
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="GBP">GBP</option>
                </select>
            </div>
            <div class="time-range-selector">
                <select id="paidTimeRange" onchange="updatePaidDateRange()">
                    <option value="today">Bug√ºn</option>
                    <option value="yesterday">D√ºn</option>
                    <option value="lastWeek">Son 7 G√ºn</option>
                    <option value="lastMonth">Son 30 G√ºn</option>
                    <option value="custom">√ñzel Tarih</option>
                </select>
            </div>
            <div id="paidDateFilter" class="date-filter" style="display: none;">
                <div class="date-filter-item">
                    <label>Ba≈ülangƒ±√ß Tarihi</label>
                    <input type="date" id="paidStartDate">
                </div>
                <div class="date-filter-item">
                    <label>Biti≈ü Tarihi</label>
                    <input type="date" id="paidEndDate">
                </div>
            </div>
            <button class="filter-button" onclick="filterPaidTable()">Filtrele</button>
            <table id="paidTable">
                <thead>
                    <tr>
                        <th>Oda No</th>
                        <th>D√∂viz</th>
                        <th>Toplam</th>
                        <th>Son Tarih</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div id="paidTotalSingle" class="single-total"></div>
            <div id="paidAllTotals" class="total-container"></div>
        </div>
    </div>

    <div id="lastTransactionsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('lastTransactionsModal')">√ó</span>
            <h2>Son ƒ∞≈ülemler</h2>
            <div class="currency-selector">
                <label>D√∂viz:</label>
                <select id="transactionsCurrency">
                    <option value="all">T√ºm√º</option>
                    <option value="TL">TL</option>
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                    <option value="GBP">GBP</option>
                </select>
            </div>
            <div class="time-range-selector">
                <select id="transactionsTimeRange" onchange="updateTransactionsDateRange()">
                    <option value="today">Bug√ºn</option>
                    <option value="yesterday">D√ºn</option>
                    <option value="lastWeek">Son 7 G√ºn</option>
                    <option value="lastMonth">Son 30 G√ºn</option>
                    <option value="custom">√ñzel Tarih</option>
                </select>
            </div>
            <div id="transactionsDateFilter" class="date-filter" style="display: none;">
                <div class="date-filter-item">
                    <label>Ba≈ülangƒ±√ß Tarihi</label>
                    <input type="date" id="transactionsStartDate">
                </div>
                <div class="date-filter-item">
                    <label>Biti≈ü Tarihi</label>
                    <input type="date" id="transactionsEndDate">
                </div>
            </div>
            <button class="filter-button" onclick="filterTransactionsTable()">Filtrele</button>
            <table id="lastTransactionsTable">
                <thead>
                    <tr>
                        <th>Tarih</th>
                        <th>Oda No</th>
                        <th>D√∂viz</th>
                        <th>Tutar</th>
                        <th>ƒ∞≈ülem</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div id="transactionsTotalSingle" class="single-total"></div>
            <div id="transactionsAllTotals" class="total-container"></div>
        </div>
    </div>

    <div id="reportModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('reportModal')">√ó</span>
            <h2>Gelir Raporlarƒ±</h2>
            <div class="report-controls">
                <div class="month-navigation">
                    <span class="nav-arrow" onclick="changeMonth(-1)">‚ùÆ</span>
                    <span id="currentMonth" class="current-month"></span>
                    <span class="nav-arrow" onclick="changeMonth(1)">‚ùØ</span>
                </div>
                <div class="currency-filter">
                    <span class="currency-btn active" data-currency="TL" onclick="toggleCurrency('TL')">TL</span>
                    <span class="currency-btn" data-currency="USD" onclick="toggleCurrency('USD')">USD</span>
                    <span class="currency-btn" data-currency="EUR" onclick="toggleCurrency('EUR')">EUR</span>
                    <span class="currency-btn" data-currency="GBP" onclick="toggleCurrency('GBP')">GBP</span>
                </div>
                <div class="chart-type-selector">
                    <label>Grafik T√ºr√º:</label>
                    <select id="chartType" onchange="updateReportChart()">
                        <option value="line">√áizgi</option>
                        <option value="bar">S√ºtun</option>
                        <option value="area">Alan</option>
                    </select>
                </div>
            </div>
            <canvas id="reportChart"></canvas>
        </div>
    </div>

    <div id="statsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('statsModal')">√ó</span>
            <h2>ƒ∞statistikler</h2>
            <div class="general-stats">
                <div class="general-stat-card">
                    <div class="general-stat-header">Toplam Oda Sayƒ±sƒ±</div>
                    <div class="general-stat-value" id="totalRooms">0</div>
                    <div class="general-stat-detail">Kayƒ±tlƒ± toplam oda sayƒ±sƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">Ortalama √ñdeme Oranƒ±</div>
                    <div class="general-stat-value" id="avgPaymentRate">0%</div>
                    <div class="general-stat-detail">√ñdeme yapanlarƒ±n oranƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">Toplam ƒ∞≈ülem Sayƒ±sƒ±</div>
                    <div class="general-stat-value" id="totalTransactions">0</div>
                    <div class="general-stat-detail">Kayƒ±tlƒ± toplam i≈ülem sayƒ±sƒ±</div>
                </div>
                <div class="general-stat-card">
                    <div class="general-stat-header">En Y√ºksek √ñdemeler</div>
                    <div class="general-stat-value" id="maxTlPayment">0 TL</div>
                    <div class="general-stat-detail" id="maxTlRoom">Oda: -</div>
                </div>
            </div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">En √áok √ñdeme Yapanlar</div>
                    <div class="top-list" id="topPayers"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">En √áok √ñdeme Atlayanlar</div>
                    <div class="top-list" id="topNonPayers"></div>
                </div>
            </div>
            <div class="chart-container">
                <div class="stat-card">
                    <canvas id="paymentRatioChart"></canvas>
                </div>
                <div class="stat-card">
                    <canvas id="currencyRatioChart"></canvas>
                </div>
            </div>
            <div class="comparison-chart-container">
                <canvas id="comparisonChart"></canvas>
            </div>
        </div>
    </div>

    <div id="accountingModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('accountingModal')">√ó</span>
            <h2>Muhasebe</h2>
            <div class="time-range-selector">
                <select id="accountingTimeRange" onchange="updateAccountingDateRange()">
                    <option value="today">Bug√ºn</option>
                    <option value="yesterday">D√ºn</option>
                    <option value="lastWeek">Son 7 G√ºn</option>
                    <option value="lastMonth">Son 30 G√ºn</option>
                    <option value="custom">√ñzel Tarih</option>
                </select>
            </div>
            <div id="accountingDateFilter" class="date-filter" style="display: none;">
                <div class="date-filter-item">
                    <label>Ba≈ülangƒ±√ß Tarihi</label>
                    <input type="date" id="accountingStartDate">
                </div>
                <div class="date-filter-item">
                    <label>Biti≈ü Tarihi</label>
                    <input type="date" id="accountingEndDate">
                </div>
            </div>
            <button class="filter-button" onclick="showAccountingSummary()">G√∂ster</button>
            <div id="accountingSummary" class="accounting-summary"></div>
            <canvas id="accountingPieChart"></canvas>
        </div>
    </div>

    <div id="storageModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('storageModal')">√ó</span>
            <h2>Depolama Durumu</h2>
            <div class="storage-metrics">
                <div class="metric">
                    <span>Toplam Kayƒ±t:</span>
                    <span><span id="totalRecords">0</span>/<span id="maxRecords">5,000</span></span>
                </div>
                <div class="progress-container">
                    <div id="storageProgress" class="progress-bar" style="width: 0%;"></div>
                </div>
                <div class="progress-text" id="progressPercent">0%</div>
                <div class="storage-details">
                    <div class="storage-detail">
                        <span class="detail-label">Kullanƒ±lan Alan</span>
                        <span class="detail-value" id="usedStorage">0.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Toplam Alan</span>
                        <span class="detail-value">5.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Kalan Alan</span>
                        <span class="detail-value" id="freeStorage">5.0 MB</span>
                    </div>
                    <div class="storage-detail">
                        <span class="detail-label">Kalan Kayƒ±t</span>
                        <span class="detail-value" id="remainingRecords">5,000</span>
                    </div>
                </div>
            </div>
            <button class="report-button" onclick="generatePDFReport()">Raporla</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
